# 流水并行-示例

## ResNet50

```python
with pipelinable:
  from torchvision.models import resnet50
  model = resnet50()
exec_seq = [
    'conv1', 'bn1', 'relu', 'maxpool', 'layer1', 'layer2', 'layer3', 'layer4', 'avgpool',
    (lambda x: torch.flatten(x, 1), "behind"), #丢失的操作
  	'fc',
]
pipelinable.to_layer_list(exec_seq)
```



## SwinV2

```python
with pipelinable:
  	import timm
    model = timm.create_model("swinv2_cr_small_ns_224", pretrained=False, num_classes=10)
exec_seq = [
    "patch_embed",
    "stages",
    (lambda x: x.mean(dim=(2, 3)), "mean"), #丢失的操作
    "head",
]
pipelinable.to_layer_list(exec_seq)
```

